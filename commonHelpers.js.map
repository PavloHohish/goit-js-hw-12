{"version":3,"file":"commonHelpers.js","sources":["../src/js/render-functions.js","../src/js/pixabay-api.js","../src/main.js"],"sourcesContent":["import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nconst gallery = document.querySelector('.gallery');\nconst loadMoreBtn = document.querySelector('.load-more');\n\nexport function renderLoader() {\n  gallery.innerHTML = '';\n  const section = document.querySelector('section');\n  const loader = document.createElement('span');\n  loader.classList.add('loader');\n  section.appendChild(loader);\n  return loader;\n}\n\nexport function renderImages(images) {\n  images.forEach(image => {\n    const imageLink = document.createElement('a');\n    imageLink.classList.add('gallery-item');\n    imageLink.href = image.largeImageURL;\n    imageLink.dataset.lightbox = 'gallery';\n\n    const img = document.createElement('img');\n    img.src = image.webformatURL;\n    img.alt = image.tags;\n    img.loading = 'lazy';\n    imageLink.appendChild(img);\n\n    const overlay = document.createElement('ul');\n    overlay.classList.add('overlay');\n\n    const imageProperties = [\n      { label: 'Likes', value: image.likes },\n      { label: 'Views', value: image.views },\n      { label: 'Comments', value: image.comments },\n      { label: 'Downloads', value: image.downloads },\n    ];\n\n    imageProperties.forEach(property => {\n      const listItem = document.createElement('li');\n      listItem.classList.add('desc');\n      listItem.innerHTML = `<p>${property.label}</p><p class=\"info\">${property.value}</p>`;\n      overlay.appendChild(listItem);\n    });\n\n    imageLink.appendChild(overlay);\n\n    gallery.appendChild(imageLink);\n  });\n\n  const lightbox = new SimpleLightbox('.gallery-item', {\n    captions: true,\n    captionsData: 'alt',\n    captionPosition: 'bottom',\n    captionDelay: 250,\n  });\n\n  if (typeof SimpleLightbox !== 'undefined') {\n    lightbox.refresh();\n  }\n}\n\nexport function showErrorToast(message) {\n  iziToast.error({\n    title: 'Error',\n    message: message,\n    position: 'topRight',\n  });\n}\n\nexport function appendImages(images) {\n  renderImages(images);\n}\n\nexport function toggleLoadMoreBtn(visibility) {\n  loadMoreBtn.style.display = visibility ? 'inline-block' : 'none';\n}\n\nexport function clearGallery() {\n  gallery.innerHTML = '';\n}\n","import { showErrorToast } from './render-functions.js';\nimport axios from 'axios';\n\nconst apiKey = '43854622-acb16c386b106d84adf209c8f';\nconst perPage = 15;\nlet page = 1;\n\nexport async function fetchImages(keyword) {\n  axios.defaults.baseURL = `https://pixabay.com`;\n  const params = new URLSearchParams({\n    key: apiKey,\n    q: encodeURIComponent(keyword),\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: 'true',\n    per_page: perPage,\n    page: page,\n  });\n\n  try {\n    const response = await axios.get(`/api/`, { params });\n    const data = response.data;\n\n    if (data.hits.length === 0) {\n      showErrorToast('No images found');\n    }\n    return data;\n  } catch (error) {\n    showErrorToast('Failed to fetch images');\n    throw new Error(error.response.status);\n  }\n}\n\nexport function resetPage() {\n  page = 1;\n}\n\nexport function incrementPage() {\n  page += 1;\n}\n","import { fetchImages, resetPage, incrementPage } from './js/pixabay-api.js';\nimport {\n  renderImages,\n  showErrorToast,\n  renderLoader,\n  toggleLoadMoreBtn,\n  appendImages,\n  clearGallery,\n} from './js/render-functions.js';\n\nconst form = document.querySelector('.form');\nconst searchInput = document.querySelector('.search-input');\nconst loadMoreBtn = document.querySelector('.load-more');\nlet keyword = '';\n\nform.addEventListener('submit', async event => {\n  event.preventDefault();\n\n  keyword = searchInput.value.trim();\n\n  if (keyword === '') {\n    showErrorToast('Please enter a search term.');\n    return;\n  }\n\n  searchInput.value = '';\n\n  resetPage();\n  clearGallery();\n  toggleLoadMoreBtn(false);\n\n  const loader = renderLoader();\n\n  try {\n    const data = await fetchImages(keyword);\n    renderImages(data.hits);\n    toggleLoadMoreBtn(data.totalHits > data.hits.length);\n    loader.remove();\n  } catch (error) {\n    loader.remove();\n  }\n});\n\nloadMoreBtn.addEventListener('click', async () => {\n  incrementPage();\n\n  try {\n    const data = await fetchImages(keyword);\n    appendImages(data.hits);\n\n    const cardHeight = document\n      .querySelector('.gallery-item')\n      .getBoundingClientRect().height;\n\n    window.scrollBy({\n      top: cardHeight * 2,\n      behavior: 'smooth',\n    });\n\n    if (data.totalHits <= document.querySelectorAll('.gallery-item').length) {\n      toggleLoadMoreBtn(false);\n      showErrorToast(\n        \"We're sorry, but you've reached the end of search results.\"\n      );\n    }\n  } catch (error) {\n    console.log(error);\n    showErrorToast('Failed to load more images');\n  }\n});\n"],"names":["gallery","loadMoreBtn","renderLoader","section","loader","renderImages","images","image","imageLink","img","overlay","property","listItem","lightbox","SimpleLightbox","showErrorToast","message","iziToast","appendImages","toggleLoadMoreBtn","visibility","clearGallery","apiKey","perPage","page","fetchImages","keyword","axios","params","data","error","resetPage","incrementPage","form","searchInput","event","cardHeight"],"mappings":"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"}